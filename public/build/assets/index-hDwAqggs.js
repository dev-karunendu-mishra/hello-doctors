import{r as e}from"./app-DSGjuhbC.js";import{j as re,m as ne,f as se,x as ae,a8 as ie,D as ce,K as le,au as me,ay as pe,G as X,c as M,R as ge,S as ue,ab as de,ao as fe}from"./index-CnOAnCoO.js";import{a as Se}from"./index-CgY5VRoc.js";const w=e.createContext({}),he=t=>{const{antCls:o,componentCls:r,iconCls:n,avatarBg:a,avatarColor:i,containerSize:h,containerSizeLG:c,containerSizeSM:E,textFontSize:v,textFontSizeLG:C,textFontSizeSM:k,iconFontSize:G,iconFontSizeLG:x,iconFontSizeSM:p,borderRadius:g,borderRadiusLG:b,borderRadiusSM:P,lineWidth:R,lineType:F}=t,z=(S,u,y,d)=>({width:S,height:S,borderRadius:"50%",fontSize:u,[`&${r}-square`]:{borderRadius:d},[`&${r}-icon`]:{fontSize:y,[`> ${n}`]:{margin:0}}});return{[r]:{...ae(t),position:"relative",display:"inline-flex",justifyContent:"center",alignItems:"center",overflow:"hidden",color:i,whiteSpace:"nowrap",textAlign:"center",verticalAlign:"middle",background:a,border:`${se(R)} ${F} transparent`,"&-image":{background:"transparent"},[`${o}-image-img`]:{display:"block"},...z(h,v,G,g),"&-lg":{...z(c,C,x,b)},"&-sm":{...z(E,k,p,P)},"> img":{display:"block",width:"100%",height:"100%",objectFit:"cover"}}}},ve=t=>{const{componentCls:o,groupBorderColor:r,groupOverlapping:n,groupSpace:a}=t;return{[`${o}-group`]:{display:"inline-flex",[o]:{borderColor:r},"> *:not(:first-child)":{marginInlineStart:n}},[`${o}-group-popover`]:{[`${o} + ${o}`]:{marginInlineStart:a}}}},Ce=t=>{const{controlHeight:o,controlHeightLG:r,controlHeightSM:n,fontSize:a,fontSizeLG:i,fontSizeXL:h,fontSizeHeading3:c,marginXS:E,marginXXS:v,colorBorderBg:C}=t;return{containerSize:o,containerSizeLG:r,containerSizeSM:n,textFontSize:a,textFontSizeLG:a,textFontSizeSM:a,iconFontSize:Math.round((i+h)/2),iconFontSizeLG:c,iconFontSizeSM:a,groupSpace:v,groupOverlapping:-E,groupBorderColor:C}},q=re("Avatar",t=>{const{colorTextLightSolid:o,colorTextPlaceholder:r}=t,n=ne(t,{avatarBg:r,avatarColor:o});return[he(n),ve(n)]},Ce),D=e.forwardRef((t,o)=>{const{prefixCls:r,shape:n,size:a,src:i,srcSet:h,icon:c,className:E,rootClassName:v,style:C,alt:k,draggable:G,children:x,crossOrigin:p,gap:g=4,onError:b,...P}=t,[R,F]=e.useState(1),[z,S]=e.useState(!1),[u,y]=e.useState(!0),d=e.useRef(null),$=e.useRef(null),L=ie(o,d),{getPrefixCls:A,className:I,style:T}=ce("avatar"),B=e.useContext(w),H=()=>{if(!$.current||!d.current)return;const s=$.current.offsetWidth,l=d.current.offsetWidth;s!==0&&l!==0&&g*2<l&&F(l-g*2<s?(l-g*2)/s:1)};e.useEffect(()=>{S(!0)},[]),e.useEffect(()=>{y(!0),F(1)},[i]),e.useEffect(H,[g]);const K=()=>{b?.()!==!1&&y(!1)},m=le(s=>a??B?.size??s??"default"),J=Object.keys(typeof m=="object"?m||{}:{}).some(s=>["xs","sm","md","lg","xl","xxl"].includes(s)),O=me(J),Q=e.useMemo(()=>{if(typeof m!="object")return{};const s=pe.find(oe=>O[oe]),l=m[s];return l?{width:l,height:l,fontSize:l&&(c||x)?l/2:18}:{}},[O,m,c,x]),f=A("avatar",r),W=X(f),[U,Y]=q(f,W),Z=M({[`${f}-lg`]:m==="large",[`${f}-sm`]:m==="small"}),j=e.isValidElement(i),_=n||B?.shape||"circle",ee=M(f,Z,I,`${f}-${_}`,{[`${f}-image`]:j||i&&u,[`${f}-icon`]:!!c},Y,W,E,v,U),te=typeof m=="number"?{width:m,height:m,fontSize:c?m/2:18}:{};let N;if(typeof i=="string"&&u)N=e.createElement("img",{src:i,draggable:G,srcSet:h,onError:K,alt:k,crossOrigin:p});else if(j)N=i;else if(c)N=c;else if(z||R!==1){const s=`scale(${R})`,l={msTransform:s,WebkitTransform:s,transform:s};N=e.createElement(ge,{onResize:H},e.createElement("span",{className:`${f}-string`,ref:$,style:l},x))}else N=e.createElement("span",{className:`${f}-string`,style:{opacity:0},ref:$},x);return e.createElement("span",{...P,style:{...te,...Q,...T,...C},className:ee,ref:L},N)}),V=t=>{const{size:o,shape:r}=e.useContext(w),n=e.useMemo(()=>({size:t.size||o,shape:t.shape||r}),[t.size,t.shape,o,r]);return e.createElement(w.Provider,{value:n},t.children)},xe=t=>{const{getPrefixCls:o,direction:r}=e.useContext(ue),{prefixCls:n,className:a,rootClassName:i,style:h,maxCount:c,maxStyle:E,size:v,shape:C,maxPopoverPlacement:k,maxPopoverTrigger:G,children:x,max:p}=t,g=o("avatar",n),b=`${g}-group`,P=X(g),[R,F]=q(g,P),z=M(b,{[`${b}-rtl`]:r==="rtl"},F,P,a,i,R),S=de(x).map((d,$)=>fe(d,{key:`avatar-key-${$}`})),u=p?.count||c,y=S.length;if(u&&u<y){const d=S.slice(0,u),$=S.slice(u,y),L=p?.style||E,A=p?.popover?.trigger||G||"hover",I=p?.popover?.placement||k||"top",T={content:$,...p?.popover,placement:I,trigger:A,rootClassName:M(`${b}-popover`,p?.popover?.rootClassName)};return d.push(e.createElement(Se,{key:"avatar-popover-key",destroyOnHidden:!0,...T},e.createElement(D,{style:L},`+${y-u}`))),e.createElement(V,{shape:C,size:v},e.createElement("div",{className:z,style:h},d))}return e.createElement(V,{shape:C,size:v},e.createElement("div",{className:z,style:h},S))},ze=D;ze.Group=xe;export{ze as A};
