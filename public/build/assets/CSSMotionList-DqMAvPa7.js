import{r as y}from"./app-tmpI4mLP.js";import{W as g}from"./index-BqX9Yzb6.js";const v="add",S="keep",h="remove",E="removed";function C(n){let s;return n&&typeof n=="object"&&"key"in n?s=n:s={key:n},{...s,key:String(s.key)}}function k(n=[]){return n.map(C)}function j(n=[],s=[]){let t=[],r=0;const u=s.length,c=k(n),p=k(s);c.forEach(e=>{let i=!1;for(let a=r;a<u;a+=1){const l=p[a];if(l.key===e.key){r<a&&(t=t.concat(p.slice(r,a).map(m=>({...m,status:v}))),r=a),t.push({...l,status:S}),r+=1,i=!0;break}}i||t.push({...e,status:h})}),r<u&&(t=t.concat(p.slice(r).map(e=>({...e,status:v}))));const o={};return t.forEach(({key:e})=>{o[e]=(o[e]||0)+1}),Object.keys(o).filter(e=>o[e]>1).forEach(e=>{t=t.filter(({key:i,status:a})=>i!==e||a!==h),t.forEach(i=>{i.key===e&&(i.status=S)})}),t}function A(){return A=Object.assign?Object.assign.bind():function(n){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},A.apply(this,arguments)}const L=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function T(n,s=g){class t extends y.Component{static defaultProps={component:"div"};state={keyEntities:[]};static getDerivedStateFromProps({keys:u},{keyEntities:c}){const p=k(u);return{keyEntities:j(c,p).filter(f=>{const e=c.find(({key:i})=>f.key===i);return!(e&&e.status===E&&f.status===h)})}}removeKey=u=>{this.setState(c=>({keyEntities:c.keyEntities.map(o=>o.key!==u?o:{...o,status:E})}),()=>{const{keyEntities:c}=this.state;c.filter(({status:o})=>o!==E).length===0&&this.props.onAllRemoved&&this.props.onAllRemoved()})};render(){const{keyEntities:u}=this.state,{component:c,children:p,onVisibleChanged:o,onAllRemoved:f,...e}=this.props,i=c||y.Fragment,a={};return L.forEach(l=>{a[l]=e[l],delete e[l]}),delete e.keys,y.createElement(i,e,u.map(({status:l,...m},b)=>{const K=l===v||l===S;return y.createElement(s,A({},a,{key:m.key,visible:K,eventProps:m,onVisibleChanged:d=>{o?.(d,{key:m.key}),d||this.removeKey(m.key)}}),(d,O)=>p({...d,index:b},O))}))}}return t}const P=T();export{P as C};
